<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Réflexion sur le développement du jeu</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
    h2 { color: #2c3e50; }
    ul { margin-bottom: 20px; }
    li { margin-bottom: 10px; }
    a { color: #2980b9; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h2>Optimisations et changements apportés</h2>
  <ul>
    <li>Optimisation du bouton d'entrée du jeu : sa position a été déplacée du coin inférieur gauche vers le centre de la page pour améliorer l'expérience utilisateur.</li>
    <li>Après une analyse du code, il est apparu que les variables <code>currentSlot</code>, <code>startX</code> et <code>startY</code> avaient des significations confuses. <code>slot</code> servait à la fois de « position logique », « coordonnée d’affichage » et « référence pour l’échange », ce qui était une source de bugs. Discussion avec l’IA : <a href="https://chatgpt.com/share/693ecb01-7834-8008-9a66-eeb615f1097d">lien</a>.</li>
    <li>Décision finale : abandon du mécanisme de clic pour échanger, passage à un système de glisser-déposer et séparation des zones de pièces et de la zone fixe, simplification de la logique. Plusieurs versions de test sont disponibles ici :testprojet6t1.html . Discussion avec l’IA : <a href="https://chatgpt.com/share/693edb86-a3e8-8008-b18e-9b7c610e9bea">lien</a>.</li>
  </ul>

  <h2>Réflexion sur le processus</h2>
  <ul>
    <li><strong>Évolution de la logique :</strong> clic pour échanger → glisser-déposer → séparation des zones.  
      <ul>
        <li>Logique de clic : problèmes de décalage entre bordures et pièces, impossibilité de savoir quelle pièce était sélectionnée pour l’échange, code complexe et bugs persistants.</li>
        <li>Logique de glisser-déposer : initialement, enregistrement de la position de départ et échange avec la pièce la plus proche. Problèmes persistants de décalage et difficultés à déterminer l’échange. Tentatives de simplification uniquement avec placement manuel ont généré de nouveaux bugs.</li>
      </ul>
    </li>
    <li>Analyse de la logique de glisser-déposer :
      <ol>
        <li>Découper les pièces et enregistrer les coordonnées correctes.</li>
        <li>Mélanger aléatoirement les pièces, enregistrer positions actuelles et cibles.</li>
        <li>À la fin du glissement, si la cible est vide, placer la pièce, sinon échanger avec la pièce présente.</li>
      </ol>
    </li>
    <li>Séparation des zones :
      <ul>
        <li>Problèmes initiaux : certaines pièces dépassaient la zone de visualisation, décalage entre pièce glissée et sélectionnée, certaines bordures fixes ne pouvaient pas recevoir de pièces.</li>
        <li>Solutions : limiter la zone du pool de pièces, corriger le décalage lors de la sélection et du glissement, corriger les bordures fixes.</li>
      </ul>
    </li>
  </ul>

  <h2>Réflexion générale</h2>
  <ul>
    <li>La complexité du code dépassait mes capacités personnelles, ce qui rendait les bugs difficiles à résoudre malgré plusieurs approches.</li>
    <li>Manque de méthodologie systématique pour le débogage et la localisation des problèmes, entraînant des essais infructueux répétés.</li>
    <li>Importance future de renforcer la conception et le débogage pour gérer des problèmes complexes.</li>
    <li>En phase débutante, privilégier des projets simples et augmenter progressivement la complexité pour éviter de se retrouver bloqué dans un code trop complexe.</li>
  </ul>
</body>
</html>


flowchart TD
    A[Début du projet Puzzle Qingming] --> B[Idée initiale : échange par clic]
    
    B --> B1[Implémentation du clic pour échanger]
    B1 --> B2[Problèmes détectés]
    
    B2 --> B21[Décalage entre cadres et pièces]
    B2 --> B22[Difficulté à identifier la pièce à échanger]
    B2 --> B23[Logique complexe et bugs persistants]
    
    B23 --> C[Changement de stratégie]
    
    C --> D[Essai : échange par glisser-déposer]
    D --> D1[Enregistrement position de départ]
    D --> D2[Échange avec la pièce la plus proche]
    
    D2 --> D3[Problèmes persistants]
    D3 --> D31[Décalage toujours présent]
    D3 --> D32[Échange difficile à déterminer]
    
    D3 --> E[Tentative de simplification]
    E --> E1[Suppression de l'échange automatique]
    E1 --> E2[Placement manuel uniquement]
    E2 --> E3[Nouveaux bugs apparaissent]
    
    E3 --> F[Phase de réflexion]
    
    F --> G[Nouvelle analyse de la logique]
    G --> G1[Découper les pièces]
    G --> G2[Mélanger l'ordre aléatoirement]
    G --> G3[Comparer position actuelle et position cible]
    
    G3 --> H[Décision finale]
    H --> I[Séparation du pool de pièces et de la zone fixe]
    I --> J[Simplification de la logique]
    
    J --> K[Résolution des principaux problèmes]

## Diagramme de flux du projet

```mermaid
    A[Lancement du jeu] --> B[Scene Intro]
    B --> C[Salle des archives]
    
    C --> D[Sélection de l'œuvre Qingming]
    
    D --> E[Accès au Puzzle]
    
    E --> F[Chargement de l'image principale]
    F --> G[Découpage en 15 fragments]
    
    G --> H[Mélange aléatoire des fragments]
    H --> I[Affichage du pool de pièces]
    H --> J[Affichage des emplacements fixes]
    
    I --> K[Interaction joueur : glisser-déposer]
    
    K --> L{Emplacement cible vide ?}
    L -->|Oui| M[Placer la pièce]
    L -->|Non| N[Refuser le placement]
    
    M --> O[Vérification de la solution]
    O --> P{Puzzle résolu ?}
    
    P -->|Non| K
    P -->|Oui| Q[Puzzle validé]
    
    Q --> R[Accès à la scène Métadonnées]
    
    R --> S[Sélection des phrases erronées]
    S --> T{Toutes les erreurs trouvées ?}
    
    T -->|Non| S
    T -->|Oui| U[Succès et validation]
```



1.优化游戏入口按钮坐标，将其由页面左下角调整至页面中间，提升用户点击体验。
2.逐步理解代码后发现，currentSlot / startX / startY 的语义是混乱的，slot 被当成了“逻辑位置 + 显示坐标 + 交换依据”，这是 bug 的根源之一。
然而，调整过程代码过于复杂，bug（边框和碎片始终不同步，碎片放置交换逻辑有问题）多次尝试简化，但一直没有解决。与Ai讨论过程如下：https://chatgpt.com/share/693ecb01-7834-8008-9a66-eeb615f1097d
3.最终决定放弃点击交换逻辑，改为拖拽交换逻辑，并且分离碎片池和固定显示区域，简化代码逻辑。https://chatgpt.com/share/693edb86-a3e8-8008-b18e-9b7c610e9bea
过程反思：
1.设计思路，点击交换 -- 拖拽交换--分离碎片池和固定显示区域;
 - 点击交换逻辑实施存在问题：边框和碎片位置错位，a,b碎片交换，不知道b具体是哪一个碎片，碎片位置无法正确交换。且不符合玩家第一直觉。调试过程代码非常复杂，改动之后原问题依然存在，且经常出现新bug
 - 拖拽交换逻辑实施：记录拖拽开始位置，拖拽结束时与最近的碎片交换位置。实施过程存在问题：边框和碎片位置错位问题始终存在，交换位置不知道如何判断；尝试删除交换机制，仅仅保留手动拖拽放置，然而出现新的问题。多次尝试后，解决失败。
2.反思拖拽逻辑：1.分割碎片，记录正确的数组和碎片坐标 2.随机数组乱序，记录当前位置坐标和target位置坐标 3.拖拽结束时，判断如果目标位置没有碎片占位，则直接占位；如果有碎片，则与该碎片，交换位置
3.分离碎片池和固定显示区域，初始代码问题：碎片位置超过显示区域，导致部分碎片无法显示；拖拽碎片位置和选中碎片位置错位；固定显示区部分边框无法放置碎片
限制碎片池子区域，因为不是所有的碎片都成功显示；修复点击碎片跟选中拖拽碎片错位问题；修复固定显示区部分边框无法放置碎片问题


总体反思：
1.代码复杂性超过了个人能力范围，导致bug难以解决，尝试多种思路均未成功。
2.在面对复杂问题时，缺乏系统的调试和问题定位方法，导致多次尝试后仍未能解决问题。
3.未来应加强代码设计和调试能力，提升解决复杂问题的能力。
4.在初学者阶段，应选择简单易行的项目，逐步提升复杂度，避免过早陷入复杂代码导致的困境。